<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèéÔ∏è Carrera de Autos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            padding: 10px;
        }

        .game-container {
            text-align: center;
            width: 100%;
            max-width: 500px;
        }

        h1 {
            color: white;
            font-size: clamp(1.5em, 5vw, 3em);
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
        }

        .game-board {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 600px;
            max-height: 70vh;
            background: #333;
            border: 5px solid #fff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            margin: 0 auto;
        }

        .road {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #444;
        }

        .road-line {
            position: absolute;
            width: 10px;
            height: 60px;
            background: white;
            left: 50%;
            transform: translateX(-50%);
            animation: moveRoad 1s linear infinite;
        }

        @keyframes moveRoad {
            from {
                top: -60px;
            }
            to {
                top: 100vh;
            }
        }

        .player-car {
            position: absolute;
            width: 50px;
            height: 80px;
            bottom: 50px;
            left: 175px;
            background: #ff4444;
            border-radius: 10px 10px 5px 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            transition: left 0.1s;
            z-index: 10;
        }

        .player-car::before {
            content: '';
            position: absolute;
            width: 30px;
            height: 40px;
            background: #87CEEB;
            top: 15px;
            left: 10px;
            border-radius: 5px;
        }

        .player-car::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 20px;
            background: #333;
            bottom: -10px;
            border-radius: 0 0 10px 10px;
        }

        .enemy-car {
            position: absolute;
            width: 50px;
            height: 80px;
            background: #4444ff;
            border-radius: 10px 10px 5px 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            z-index: 5;
        }

        .enemy-car::before {
            content: '';
            position: absolute;
            width: 30px;
            height: 40px;
            background: #87CEEB;
            top: 15px;
            left: 10px;
            border-radius: 5px;
        }

        .score-panel {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            color: white;
            font-size: clamp(1em, 3vw, 1.5em);
            font-weight: bold;
            padding: 0 10px;
        }

        .score-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            flex: 1;
            min-width: 120px;
        }

        .controls {
            margin-top: 20px;
            color: white;
            font-size: clamp(0.9em, 2.5vw, 1.1em);
            padding: 0 20px;
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: clamp(20px, 5vw, 40px);
            border-radius: 20px;
            text-align: center;
            z-index: 100;
            display: none;
            max-width: 90%;
        }

        .game-over h2 {
            font-size: clamp(2em, 6vw, 3em);
            margin-bottom: 20px;
            color: #ff4444;
        }

        .game-over p {
            font-size: clamp(1em, 3vw, 1.5em);
            margin-bottom: 30px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: clamp(10px, 2vw, 15px) clamp(20px, 4vw, 40px);
            border-radius: 25px;
            font-size: clamp(1em, 2.5vw, 1.2em);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            margin: 5px;
            touch-action: manipulation;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        button:active {
            transform: translateY(0);
        }

        .start-screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: clamp(20px, 5vw, 40px);
            border-radius: 20px;
            text-align: center;
            z-index: 100;
            max-width: 90%;
        }

        .start-screen h2 {
            font-size: clamp(1.5em, 5vw, 2.5em);
            margin-bottom: 20px;
            color: #4CAF50;
        }

        .start-screen p {
            font-size: clamp(0.9em, 2.5vw, 1.2em);
            margin-bottom: clamp(15px, 3vw, 30px);
        }

        .lane-marker {
            position: absolute;
            width: 5px;
            height: 100%;
            background: #666;
        }

        .lane-marker.left {
            left: 33%;
        }

        .lane-marker.right {
            right: 33%;
        }

        .mobile-controls {
            display: none;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .mobile-btn {
            width: 80px;
            height: 80px;
            font-size: 2em;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 3px solid white;
        }

        .mobile-btn:active {
            background: rgba(255, 255, 255, 0.4);
        }

        @media (max-width: 768px) {
            .mobile-controls {
                display: flex;
            }
            
            .controls {
                display: none;
            }
            
            h1 {
                margin-bottom: 10px;
            }
            
            .game-board {
                max-height: 60vh;
            }
            
            .score-panel {
                margin-top: 10px;
            }
        }

        @media (max-width: 480px) {
            .game-board {
                border-width: 3px;
                max-height: 55vh;
            }
            
            .score-item {
                padding: 8px 15px;
                min-width: 100px;
            }
            
            .mobile-btn {
                width: 70px;
                height: 70px;
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>üèéÔ∏è CARRERA DE AUTOS üèÅ</h1>
        
        <div class="game-board" id="gameBoard">
            <div class="road">
                <div class="lane-marker left"></div>
                <div class="lane-marker right"></div>
            </div>
            
            <div class="player-car" id="playerCar"></div>
            
            <div class="start-screen" id="startScreen">
                <h2>üèÅ ¬°Listo para la carrera! üèÅ</h2>
                <p><strong>Controles:</strong></p>
                <p>‚Üê Flecha Izquierda: Mover a la izquierda</p>
                <p>‚Üí Flecha Derecha: Mover a la derecha</p>
                <p><br>¬°Esquiva los autos y consigue la m√°xima puntuaci√≥n!</p>
                <button onclick="startGame()">INICIAR JUEGO</button>
            </div>
            
            <div class="game-over" id="gameOver">
                <h2>üí• GAME OVER üí•</h2>
                <p>Puntuaci√≥n Final: <span id="finalScore">0</span></p>
                <p>R√©cord: <span id="highScore">0</span></p>
                <button onclick="restartGame()">JUGAR DE NUEVO</button>
            </div>
        </div>
        
        <div class="score-panel">
            <div class="score-item">
                üèÜ Puntos: <span id="score">0</span>
            </div>
            <div class="score-item">
                üöó Esquivados: <span id="dodged">0</span>
            </div>
        </div>
        
        <div class="controls">
            ‚å®Ô∏è Usa las flechas ‚Üê ‚Üí para mover tu auto
        </div>
        
        <div class="mobile-controls" id="mobileControls">
            <button class="mobile-btn" id="leftBtn">‚óÄ</button>
            <button class="mobile-btn" id="rightBtn">‚ñ∂</button>
        </div>
    </div>

    <script>
        const gameBoard = document.getElementById('gameBoard');
        const playerCar = document.getElementById('playerCar');
        const scoreDisplay = document.getElementById('score');
        const dodgedDisplay = document.getElementById('dodged');
        const gameOverScreen = document.getElementById('gameOver');
        const startScreen = document.getElementById('startScreen');
        const finalScoreDisplay = document.getElementById('finalScore');
        const highScoreDisplay = document.getElementById('highScore');

        let playerPosition = 1; // 0 = izquierda, 1 = centro, 2 = derecha
        let score = 0;
        let dodgedCars = 0;
        let gameRunning = false;
        let enemyCars = [];
        let roadLines = [];
        let gameSpeed = 5;
        let spawnRate = 100;
        let frameCount = 0;
        let highScore = localStorage.getItem('highScore') || 0;
        let boardHeight = 600;
        let boardWidth = 400;

        const lanes = [75, 175, 275]; // Posiciones X de los carriles

        // Actualizar r√©cord al cargar
        highScoreDisplay.textContent = highScore;

        // Funci√≥n para actualizar dimensiones del tablero
        function updateBoardDimensions() {
            const rect = gameBoard.getBoundingClientRect();
            boardHeight = rect.height;
            boardWidth = rect.width;
            
            // Actualizar posiciones de carriles proporcionalmente
            lanes[0] = boardWidth * 0.1875; // 75/400
            lanes[1] = boardWidth * 0.4375; // 175/400
            lanes[2] = boardWidth * 0.6875; // 275/400
            
            // Reposicionar jugador si est√° en juego
            if (playerCar) {
                playerCar.style.left = lanes[playerPosition] + 'px';
            }
        }

        // Actualizar dimensiones al inicio y al cambiar tama√±o
        updateBoardDimensions();
        window.addEventListener('resize', updateBoardDimensions);

        // Crear l√≠neas de carretera
        function createRoadLines() {
            const lineCount = Math.ceil(boardHeight / 60) + 2;
            for (let i = 0; i < lineCount; i++) {
                const line = document.createElement('div');
                line.className = 'road-line';
                line.style.top = (i * 60) + 'px';
                line.style.animationDelay = (i * 0.1) + 's';
                gameBoard.querySelector('.road').appendChild(line);
                roadLines.push(line);
            }
        }

        // Mover jugador
        function movePlayer(direction) {
            if (!gameRunning) return;

            if (direction === 'left' && playerPosition > 0) {
                playerPosition--;
            } else if (direction === 'right' && playerPosition < 2) {
                playerPosition++;
            }

            playerCar.style.left = lanes[playerPosition] + 'px';
        }

        // Controles de teclado
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                movePlayer('left');
            } else if (e.key === 'ArrowRight') {
                movePlayer('right');
            }
        });

        // Controles t√°ctiles para m√≥vil
        const leftBtn = document.getElementById('leftBtn');
        const rightBtn = document.getElementById('rightBtn');

        if (leftBtn && rightBtn) {
            leftBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                movePlayer('left');
            });

            rightBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                movePlayer('right');
            });

            // Tambi√©n permitir clicks para pruebas en desktop
            leftBtn.addEventListener('click', (e) => {
                e.preventDefault();
                movePlayer('left');
            });

            rightBtn.addEventListener('click', (e) => {
                e.preventDefault();
                movePlayer('right');
            });
        }

        // Crear auto enemigo
        function createEnemyCar() {
            const enemyCar = document.createElement('div');
            enemyCar.className = 'enemy-car';
            
            const randomLane = Math.floor(Math.random() * 3);
            enemyCar.style.left = lanes[randomLane] + 'px';
            enemyCar.style.top = '-80px';
            
            // Colores aleatorios
            const colors = ['#4444ff', '#44ff44', '#ffff44', '#ff44ff', '#44ffff', '#ff8800'];
            enemyCar.style.background = colors[Math.floor(Math.random() * colors.length)];
            
            gameBoard.appendChild(enemyCar);
            enemyCars.push({
                element: enemyCar,
                lane: randomLane,
                y: -80
            });
        }

        // Actualizar posici√≥n de enemigos
        function updateEnemies() {
            for (let i = enemyCars.length - 1; i >= 0; i--) {
                const enemy = enemyCars[i];
                enemy.y += gameSpeed;
                enemy.element.style.top = enemy.y + 'px';

                // Verificar si pas√≥ al jugador (esquivado)
                const playerY = boardHeight - 80;
                if (enemy.y > playerY - 10 && enemy.y < playerY + 10) {
                    if (enemy.lane !== playerPosition) {
                        dodgedCars++;
                        score += 10;
                        dodgedDisplay.textContent = dodgedCars;
                        scoreDisplay.textContent = score;
                    }
                }

                // Detectar colisi√≥n
                if (checkCollision(enemy)) {
                    endGame();
                    return;
                }

                // Eliminar si sali√≥ de la pantalla
                if (enemy.y > boardHeight) {
                    enemy.element.remove();
                    enemyCars.splice(i, 1);
                }
            }
        }

        // Detectar colisi√≥n
        function checkCollision(enemy) {
            const playerY = boardHeight - 80;
            const playerLane = playerPosition;

            if (enemy.lane === playerLane) {
                if (enemy.y > playerY - 80 && enemy.y < playerY + 80) {
                    return true;
                }
            }
            return false;
        }

        // Aumentar dificultad
        function increaseDifficulty() {
            if (frameCount % 500 === 0) {
                if (gameSpeed < 12) {
                    gameSpeed += 0.5;
                }
                if (spawnRate > 50) {
                    spawnRate -= 5;
                }
            }
        }

        // Loop principal del juego
        function gameLoop() {
            if (!gameRunning) return;

            frameCount++;

            // Crear nuevos enemigos
            if (frameCount % spawnRate === 0) {
                createEnemyCar();
            }

            // Actualizar enemigos
            updateEnemies();

            // Aumentar dificultad
            increaseDifficulty();

            requestAnimationFrame(gameLoop);
        }

        // Iniciar juego
        function startGame() {
            startScreen.style.display = 'none';
            gameRunning = true;
            score = 0;
            dodgedCars = 0;
            playerPosition = 1;
            gameSpeed = 5;
            spawnRate = 100;
            frameCount = 0;
            enemyCars = [];

            playerCar.style.left = lanes[1] + 'px';
            scoreDisplay.textContent = '0';
            dodgedDisplay.textContent = '0';

            // Limpiar enemigos anteriores
            document.querySelectorAll('.enemy-car').forEach(car => car.remove());

            gameLoop();
        }

        // Terminar juego
        function endGame() {
            gameRunning = false;
            finalScoreDisplay.textContent = score;

            // Actualizar r√©cord
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('highScore', highScore);
                highScoreDisplay.textContent = highScore;
            }

            gameOverScreen.style.display = 'block';

            // Detener animaci√≥n de l√≠neas
            roadLines.forEach(line => {
                line.style.animationPlayState = 'paused';
            });
        }

        // Reiniciar juego
        function restartGame() {
            gameOverScreen.style.display = 'none';
            
            // Reiniciar animaci√≥n de l√≠neas
            roadLines.forEach(line => {
                line.style.animationPlayState = 'running';
            });
            
            startGame();
        }

        // Inicializar
        createRoadLines();
    </script>
</body>
</html>
